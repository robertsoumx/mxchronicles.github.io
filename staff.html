<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MX Chronicles · Staff Portal</title>
<link rel="stylesheet" href="style.css">
<script src="data.js" defer></script>
<script src="script.js" defer></script>
</head>
<body onload="showStaffLogin()">

<header class="site-header">
  <div class="masthead">MX CHRONICLES</div>
  <nav class="nav-tabs">
    <a href="index.html">HOME</a>
    <a href="articles.html">ARTICLES</a>
    <a href="about.html">ABOUT</a>
    <a href="staff.html" class="active">STAFF PORTAL</a>
  </nav>
</header>

<main id="staff-container"></main>

<script>
const STAFF_PASSWORD="26MXChronicles";

function showStaffLogin(){
  const container=document.getElementById('staff-container');
  container.innerHTML=`
    <section class="issue-section">
      <div class="issue-overlay">
        <h2>STAFF PORTAL LOGIN</h2>
        <input type="password" id="staff-pass" placeholder="Enter password" style="padding:0.5rem; font-size:1rem; width:200px;">
        <button onclick="checkStaffPassword()" style="padding:0.5rem 1rem; margin-left:0.5rem;">Enter</button>
        <div id="staff-error" style="color:red; margin-top:0.5rem;"></div>
      </div>
    </section>
  `;
}

function checkStaffPassword(){
  const pass=document.getElementById('staff-pass').value;
  if(pass===STAFF_PASSWORD) renderStaffPortal();
  else document.getElementById('staff-error').innerText="Incorrect password";
}

function renderStaffPortal(){
  const container=document.getElementById('staff-container');
  container.innerHTML='';

  // ARTICLES
  const articleSection=document.createElement('section');
  articleSection.className='issue-section';
  articleSection.innerHTML='<div class="issue-overlay"><h2>MANAGE ARTICLES</h2></div>';
  const articleContainer=document.createElement('div');
  articleContainer.className='articles-container issue-layout';
  const layoutAreas=['feature','side1','side2','side3','side4'];
  Object.entries(articles).forEach(([id,a],i)=>{
    const artDiv=document.createElement('div');
    artDiv.className='article-block';
    artDiv.style.gridArea=layoutAreas[i%layoutAreas.length];
    artDiv.innerHTML=`
      <h3 class="article-title">${a.title}</h3>
      <div class="meta">${a.author} · ${a.date}</div>
      <p style="font-size:0.9rem; margin-top:0.5rem;">
        <button onclick="editArticle('${id}')">Edit</button>
        <button onclick="deleteArticle('${id}')">Delete</button>
        <button onclick="toggleFeature('${id}')">${a.featured?'Unfeature':'Feature'}</button>
      </p>
    `;
    articleContainer.appendChild(artDiv);
  });
  articleSection.querySelector('.issue-overlay').appendChild(articleContainer);
  container.appendChild(articleSection);

  // STAFF
  const staffSection=document.createElement('section');
  staffSection.className='issue-section';
  staffSection.innerHTML=`
    <div class="issue-overlay">
      <h2>MANAGE STAFF</h2>
      <input type="text" id="new-staff" placeholder="Add staff member" style="padding:0.5rem; width:200px;">
      <button onclick="addStaff()">Add</button>
      <div id="staff-list"></div>
    </div>
  `;
  container.appendChild(staffSection);
  renderStaffList();
}

function renderStaffList(){
  const listContainer=document.getElementById('staff-list');
  listContainer.innerHTML='';
  staff.forEach((s,i)=>{
    const div=document.createElement('div');
    div.style.margin='0.5rem 0';
    div.innerHTML=`${s} <button onclick="removeStaff(${i})">Remove</button>`;
    listContainer.appendChild(div);
  });
}

function addStaff(){
  const name=document.getElementById('new-staff').value.trim();
  if(name){ staff.push(name); renderStaffList(); document.getElementById('new-staff').value=''; }
}
function removeStaff(idx){ staff.splice(idx,1); renderStaffList(); }

function editArticle(id){
  const newTitle=prompt("Enter new title", articles[id].title);
  if(newTitle) articles[id].title=newTitle;
  renderStaffPortal();
}
function deleteArticle(id){
  if(confirm("Delete this article?")){ delete articles[id]; renderStaffPortal(); }
}
function toggleFeature(id){
  articles[id].featured=!articles[id].featured;
  renderStaffPortal();
}
</script>
</body>
</html>
